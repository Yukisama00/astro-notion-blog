---
import * as interfaces from '../../lib/interfaces'
import { filePath } from '../../lib/blog-helpers'
import Caption from './Caption.astro'

export interface Props {
  block: interfaces.Block
}

const { block } = Astro.props

let image = ''
if (block.Image.External) {
  image = block.Image.External.Url
} else if (block.Image.File) {
  image = filePath(new URL(block.Image.File.Url))
}
---

<figure class="image">
  {
    image && (
      <div>
        <div>
          <img src={image} alt="Image in a image block" loading="lazy" />
        </div>
        <Caption richTexts={block.Image.Caption} />
      </div>
    )
  }
</figure>

<style>
  .image {
    display: flex;
    margin: 0 auto;
  }
  .image > div {
    margin: 0 auto;
  }
  .image > div > div {
    line-height: 0;
  }
  .image > div > div img {
    display: block;
    max-width: 100%;
  }
</style>
